<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React 新版生命週期 getSnapshotBeforeUpdate 介紹</title>
    <style>
        .list{
            width: 200px;
            height: 150px;
            background-color: paleturquoise;
            overflow: auto;
        }
        .message{
            height: 30px;
        }
    </style>
</head>
<body>
    <!-- 準備好一個容器 -->
    <div id="test"></div>
    <!-- 引入 react 核心庫 -->
    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <!-- 引入 react-dom，用於 react 操作 DOM -->
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <!-- 引入 babel，用於將 jsx 轉為 js -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <!-- 引入 prop-type 用於對組件的標淺屬性進行檢查與限制 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.6.0/prop-types.js"></script>

    <script type="text/babel">
        class Person extends React.Component {
            
            state = {persons:[
                {id:1, name:'steven', age:20},
                {id:2, name:'amy', age:18}
            ]}

            add = () => {
                console.log(this.refs.name.value)
                console.log(this.refs.age.value)
                const {persons} = this.state
                const person = {id:3, name:this.refs.name.value, age:this.refs.age.value}
                this.setState({persons:[person, ...persons]})
            }

            render() {
                return (
                    <div>
                        新增人員: <input ref="name" type="text"/>
                        年齡: <input ref="age" type="number"/>
                        <button onClick={this.add}>添加</button>
                        <h2>人員列表</h2>
                        <h3>使用 index 作為 key</h3>
                        <ul>
                            {
                                this.state.persons.map((person, index) => {
                                    return <li key={index}>{person.name} - {person.age}<input type="text"/></li>
                                })
                            }
                        </ul>
                        <hr/>
                        <h3>使用 id 作為 key</h3>
                        <ul>
                            {
                                this.state.persons.map((person) => {
                                    return <li key={person.id}>{person.name} - {person.age}<input type="text"/></li>
                                })
                            }
                        </ul>
                    </div>
                )
            }
        }
        ReactDOM.render(<Person/>, document.getElementById('test'))
    </script>
</body>
</html>